{% extends "inicio_base.html" %}
{% load staticfiles%}
{% load hitcount_tags %}

{% block content %}
{% if request.user.is_authenticated and request.user.is_staff %}
<main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content" role="main">

  <div class="artigo">
    <p>Total de artigos: {{ n_artigos }} </p>
    <p>Total de hits em 24 horas: {{ hits_dia }}</p>
    <p>Total de hits em uma semana: {{ hits_semana }}</p>
    <p>Total de hits em um mês: {{ hits_mes }}</p>
  </div>

  {% for artigo in artigo_list %}
      <div class="artigo">
        <h2><a href="{% url 'detalhe_artigo' pk=artigo.pk %}">{{ artigo.titulo }}</a></h2>
        <p>{{ artigo.introducao|truncatechars:200 }}</p>
        <dl class="dl-horizontal">
          <dt>Hits Totais:</dt>
          <dd>{% get_hit_count for artigo %}</dd>
          <dt>Hits nos últimos 7 dias:</dt>
          <dd>{% get_hit_count for artigo within "days=7" %}</dd>
          <dt>Hits nas últimas 24 horas:</dt>
          <dd>{% get_hit_count for artigo within "days=1" %}</dd>
        </dl>
      </div>
  {% endfor %}
</main>
{% endif %}
{% endblock %}

{% block barra-esquerda %}

{% if request.user.is_authenticated %}

<div class="col-12 col-md-3 col-xl-2 bd-sidebar">

  <div class="bd-search d-flex align-items-center">
    <a class="bd-toc-link"></a>
    <button class="btn btn-link bd-search-docs-toggle d-md-none p-0 ml-3" type="button" data-toggle="collapse" data-target="#bd-docs-nav" aria-controls="bd-docs-nav" aria-expanded="false" aria-label="Toggle docs navigation"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 30 30" width="30" height="30" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M4 7h22M4 15h22M4 23h22"/></svg>
    </button>
  </div>

  <nav class="collapse bd-links" id="bd-docs-nav">
    <div class="bd-toc-item">
      <a class="bd-toc-link" href="/">INÍCIO</a>
      <a class="bd-toc-link" href="#">EXERCÍCIOS</a>

      {% if request.user.is_authenticated and request.user.is_staff %}
      <a class="bd-toc-link" href="{% url 'administracao' %}">CONTAGEM DE ARTIGOS</a>
      {% endif %}

    </div>
  </nav>

</div>

{% endif %}

{% endblock %}
